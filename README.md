# Carbonfiber
탄소복합재생성공정_VR체험

#엠라인스튜디오 입사 첫 프로젝트.

2020-09월초 ~ 2020-12월말 동한 진행된 탄소복합재 생성공정 프로젝트이다. 

내 개발 투입 시기는 10월초에 서브개발자로 투입되었다. 

한국탄소융합기술원의 교육용컨텐츠를 개발하였다. 

컨텐츠 구성은 튜토리얼->NCF->자동재단기->프레스->OX퀴즈 순서로 진행되며 5명의 체험자가 멀티환경에서 체험을 하게된다.  

리슨서버를 사용하여 관리자는 서버로 체험에 참여하지만 인터렉션은 진행할 수 없으며 체험자들은 클라이언트로 각각 컨텐츠를 인터렉션을 통해 체험을 하게된다. 

전체 컨텐츠중 자동재단기와 OX퀴즈 파트를 개발하였다.  

리소스는 사내의 아트팀에서 만들어 준 것으로 사용하였다. 

컨텐츠의 개발은 블루프린트를 이용하여 구현하였다. 

#구조

전체의 스탭구조는 튜토리얼->NCF->자동재단기->프레스->OX퀴즈 이며
내가 개발한 자동재단기 컨텐츠의 구조는 3개의 메인스탭(Mainstep)과 23개의 서브스탭(Substep)으로 나뉘어져 있다.

메인스탭은 1스타트스탭, 2스탭매니져, 3엔드스탭 순서로 흘러가며 스탭매너져 에서 23개의 서브스탭을 관리하는 구조이다.
스타트스탭에서 조건이 충족된다면 2번 스탭매니져로 이동한다.
스탭매니져에서는 23개의 서브스탭을 진행한다. 23개의 체험을 컨텐츠를 참여한 플레이어들이 모두 체험을 마쳤다면 엔드스탭으로 넘어간다.
엔드스탭에서는 모든 플레이어를 지정된 공간안에 모여있는지 확인 후 조건이 충족된다면 프레스 컨텐츠로 이동시킨다.

#개발하며 중요하다고 생각했던것들

멀티플레이 구조를 이해하여 구현해야했다.
서버-클라이언트 이벤트처리, 서버-클라이언트간 이벤트 타이밍, 소유권처리, 스탭의 리셋처리 등이 있었다.

1-서버-클라이언트 이벤트처리

멀티플레이 환경의 컨텐츠 개발에서 대부분의 이벤트 처리는 서버에서 진행하게 된다. 클라이언트에서 인터렉션을 진행하면 서버로 패킷을 날려 체크-> 모두에서 실행 하는 식으로 진행하여야 했다.

인터렉션 이벤트 처리가 클라이언트에서만 또는 서버/클라이언트 모두 진행된다면 클리이언트는 진행됫으나 서버는 진행안되는 상황 또는 그 반대의 생황이 생기기도 했다. 이런 문제를 발생시키지 않기 위해 대부분의 이벤트 처리는 서버에서 진행하였다.

2-서버-클라인트간 이벤트 타이밍

1번 서버에 패킷을 날리고 돌아오는 시간 문제 때문에 이벤트가 씹히는 문제가 생기곤 했다. 명확한 이벤트 처리를 해야했다. 서버에서 패킷을 받고 진행하는식의 처리로 개발해였다.

3-소유권처리

스탭매니져의 서브스탭을 진행하는 체험자는 해당 기기(스탭)의 소유권을 가진다. 다른 플레이어의 간섭을 받지않고 체험을 진행할 수 있도록 구현했다.
다른 체험자의 진행으로 체험에 방해가 되는 요소(사운드,NPC,스폰되는 액터)막기 위해서는 해당기기를 소유한 클라이언트에서만 이벤트를 발생시켜야 했다.

4-스탭의 리셋처리

월드내에 배치된 재단기는 3대로 5명의 체험자들이 2그룹으로 나뉘어서 체험을 진행해야한다.

한명의 체험자가 모든 체험을 완료했다면 체험을 진행하지 않은 체험자들을 위해서 자리를 비워줘야한다. 이때 이전체험자가 진행한 부분을 처음상태로 되돌려 놓고 소유권도 초기화 한다.

리셋의 처리는 튜토리얼->NCF 또는 재단기->프레스 처럼 컨텐츠를 이동할 때는 이전컨텐츠와 해당컨텐츠 전체리셋을 하고 한명의 체험자가 체험을 완료했을때는 스탭매니져의 리셋만 실행한다.
